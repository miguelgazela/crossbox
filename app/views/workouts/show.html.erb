<%= render "./navbar" %>

<div class="container">

  <div class="row">

      <div class="col-xs-12 col-md-8">
        
        <div class="card padded-xs-card">

          <h1 class="page-header hidden-xs">Aula <%= @workout.date.strftime("%d/%m/%Y %H:%M") %></h1>

          <h3 class="page-header hidden-sm hidden-md hidden-lg text-center">Aula <%= @workout.date.strftime("%d/%m/%Y %H:%M") %></h3>
  
          <h4>Pessoas Inscritas

          <% if @workout.trainings.length >= Integer(@workout.max_participants) %>
          (0 vagas):
          <% else %>
          
            <% if Integer(@workout.max_participants) - @workout.trainings.length == 1 %>
              (<%= Integer(@workout.max_participants) - @workout.trainings.length %> vaga):
            <% else %>
              (<%= Integer(@workout.max_participants) - @workout.trainings.length %> vagas):
            <% end %>

          <% end %>

          </h4>

          <% if @workout.trainings.length == 0 %>

          <p>Ainda ninguém se inscreveu nesta aula. Sê o primeiro/a!</p>

          <% else %>
            
            <div class="table-responsive">
              <table class="table">
              <thead>
                <tr>
                  <th>#</th>
                  <th></th>
                  <th>Nome</th>
                  <th>Convidados</th>
                  <th class="hidden-xs">Inscrição</th>
                </tr>
              </thead>
              <tbody>

              <% @workout.trainings.order(:id)[0,Integer(@workout.max_participants)].each_with_index do |training, index| %>

                <tr>
                  <th scope="row"><%= index + 1 %></th>
                  <td><img class="media-object media-object-small" src="<%= training.user.image %>" alt="..."></td>
                  <td><%= training.user.name %></td>
                  <td><%= training.guests || '0' %></td>
                  <td class="hidden-xs"><%= training.created_at.strftime("%d/%m/%Y") %></td>
                </tr>

              <% end %>

              </tbody>
              </table>
            </div>

          <% end %>

          <% if @workout.trainings.length > Integer(@workout.max_participants) %>

          <h4>Em espera:</h4>
          <p>Quem estiver na lista de espera pode treinar na mesma, mas faz outro treino com o restante material disponível. Se alguma pessoa com uma das vagas desistir, a vaga será imediatamente ocupada pela primeira pessoa na lista de espera.</p>
          
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th>#</th>
                  <th></th>
                  <th>Nome</th>
                  <th>Convidados</th>
                  <th class="hidden-xs">Inscrição</th>
                </tr>
              </thead>
              <tbody>

              <% @workout.trainings.order(:id)[Integer(@workout.max_participants), 100].each_with_index do |training, index| %>

                <tr>
                  <th scope="row"><%= index + 1 + Integer(@workout.max_participants) %> </th>
                  <td><img class="media-object media-object-small" src="<%= training.user.image %>" alt="..."></td>
                  <td><%= training.user.name %></td>
                  <td><%= training.guests || '0' %></td>
                  <td class="hidden-xs"><%= training.created_at.strftime("%d/%m/%Y") %></td>
                </tr>

              <% end %>

              </tbody>
              </table>
            </div>

          <% end %>

          <hr>

          <div>
            <% if @in_workout %>

              <button id="showChangeGuestsUIBtn" class="btn btn-default btn-block hidden-sm hidden-md hidden-lg" onclick="showChangeGuestsUI(this)"><%= fa_icon "users" %> Alterar Número de Convidados</button>

              <h4 class="hidden" id="changeGuestsUITitle">Alterar Número de Convidados</h4>

              <div class="hidden" id="changeGuestsUIRadios" style="margin-bottom: 15px;">
                <input type="hidden" name="numGuests" value="<%= @in_workout.guests %>" id="numGuests">
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="0" <% if @in_workout.guests == 0 %>checked<% end %> onclick="changeGuests('0')">0
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="1" <% if @in_workout.guests == 1 %>checked<% end %> onclick="changeGuests('1')">1
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="2" <% if @in_workout.guests == 2 %>checked<% end %> onclick="changeGuests('2')">2
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="3" <% if @in_workout.guests == 3 %>checked<% end %> onclick="changeGuests('3')">3
                </label>
              </div>

              <div class="hidden" id="changeGuestsUIButtons">

                <button type="button" style="margin-bottom: 10px;" class="btn btn-default btn-block hidden-sm hidden-md hidden-lg" onclick="updateNumGuests(<%= @workout.id %>)"><%= fa_icon "save" %> Alterar</button>
                <button type="button" style="margin-bottom: 10px;" class="btn btn-default hidden-xs" onclick="updateNumGuests(<%= @in_workout.id %>)"><%= fa_icon "save" %> Alterar</button>

                <button type="button" class="btn btn-default btn-block hidden-sm hidden-md hidden-lg" onclick="hideChangeGuestsUI()"><%= fa_icon "times-circle" %> Cancelar</button>
                <button type="button" class="btn btn-default hidden-xs" onclick="hideChangeGuestsUI()"><%= fa_icon "times-circle" %> Cancelar</button>

              </div>

              <hr>

              <a href="/workouts/<%= @workout.id %>/state?a=leave" class="btn btn-default btn-block hidden-sm hidden-md hidden-lg"><%= fa_icon "thumbs-down" %> Retirar Inscrição</a>
              <a href="/workouts/<%= @workout.id %>/state?a=leave" class="btn btn-default hidden-xs"><%= fa_icon "thumbs-down" %> Retirar Inscrição</a>

            <% else %>

              <h4>Convidados - <small>Pessoas que vais trazer contigo para experimentarem a Box.</small></h4>

              <div style="margin-bottom: 15px;">
                <input type="hidden" name="numGuests" value="0" id="numGuests">
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="0" checked onclick="changeGuests('0')">0
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="1" onclick="changeGuests('1')">1
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="2" onclick="changeGuests('2')">2
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" value="3" onclick="changeGuests('3')">3
                </label>
              </div>

              <hr>

              <% if @workout.trainings.length >= Integer(@workout.max_participants) %>

                <a href="/workouts/<%= @workout.id %>/state?a=enter" class="btn btn-default hidden-xs"><%= fa_icon "users" %> Entrar para Fila de Espera</a>
                <a href="/workouts/<%= @workout.id %>/state?a=enter" class="btn btn-default btn-block hidden-sm hidden-md hidden-lg"><%= fa_icon "users" %> Entrar para Fila de Espera</a>

              <% else %>

                <button type="button" class="btn btn-default hidden-xs" onclick="enterWorkout(<%= @workout.id %>)"><%= fa_icon "thumbs-up" %> Inscrever na Aula</button>
                <button type="button" class="btn btn-default btn-block hidden-sm hidden-md hidden-lg" onclick="enterWorkout(<%= @workout.id %>)"><%= fa_icon "thumbs-up" %> Inscrever na Aula</button>

              <% end %>
            <% end %>

          </div>

        </div> <!-- /card -->

      </div> <!-- /col-xs-12 -->

      <div class="col-xs-12 col-md-4">
        
        <div class="card padded-xs-card">
  
          <h1 class="page-header">Patrocínios</h1>

          <a href="http://www.medilast-sport.com/es/bienvenidos.aspx">
          <%= image_tag("medilast", class:"img-responsive") %>
          </a>

          <hr>

          <a href="http://elitetacticalboots.net">
          <%= image_tag("tactical", class:"img-responsive") %>
          </a>

          <hr>

          <a href="https://www.facebook.com/Healthy-food-at-home-1014633131891876/">
          <%= image_tag("footathome", class:"img-responsive") %></a>

          <hr>

          <a href="https://www.facebook.com/littleheavenphotoandscrap">
          <%= image_tag("littleheaven", class:"img-responsive") %></a>

        </div> <!-- /card -->
      </div> <!-- /col-xs-12 -->

    </div>
  </div>
